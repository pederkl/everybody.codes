(defparameter *input-1*
  "AABBBCBABCBBABCBAAACABCAACBCBCBCABACAABCBCBAABCCABBCCACABBCBAAABAACCAACCAACCBBAAABBBBACCBCBBBCBAAAAABAABBACBCBBABAABCABBCBBCABBBCBBCACBBCCBCAAACABAABABAAACBBCACCCCCBAACCCCAACABBBABBBCABCACAAABCCCAACCCCAABBCBBCCBAABBAABCBABAAAACACBABCCCBACCCBBABACAACBACCACCAABAACABCACCAAABBCCAAAAABAABCCACBCBCCCAABCBABBCBACAAAABBCBCCCCCAABCCBCABACACAAAACCABCCAABAACCABBACBAAACCAAACBCBCACBCBBCABAABACCACBCCAAAABABAAABCBBBBCBACACABABBCAACBAACABBCACBCBBBACCBBBCCABACACBBACAACBACAAACCACBACCBAABBABCBABBCCBCACCBAACBABBAABBABCABAABABBABBACCABAAACBBCBCAAACACABBAAACCABBBACCCBBCCABBBCCCAABCCBAABACBACCBCCCABCBABAAACCACCCCCCCABCBAAABBABABBACABBCBACAABBCCBAACBCACABBACBCACCAABBACABBACCAAAAABBCAACABAACBBBBAABAABCBBCCBCCACCBCCCBACCCBAAAABBACCAABABCACCCAABACACCAACBCBBABCACBCBBCBBACBCAAABACCABACBBBBACBBCCBCABCCABACBCAAABAAABCCAACACCCCBCABACACBACBACCBABACACCACCAABCCACCCBCCCCBAACAABBAACCBABCAABCABACCCAABBCCABACACCBCAACACAACBCBCBCCAABAACCABAABBABBAABBBACBABBBCCBAACAABCCACBCBCCCCCBCBACCCCBACCBBCBBBABCACBBBACACCACBBCBCCBBCACACCCC")

(defparameter *input-2* "DABCxDBBDAABCBDBDBDDBACDCBADxBBDDxAABxxAACBCABDADABBBDBxCxAACACxCAAADxAACDCAxAACAxCBABDDxCAAAxCCBBDBDBBAADCAADADDBCDDAABDBDADBAADACABCBDAADDxCCBDADAAAADCBxAABDCADxBxADCADBxxDCDBCDDBDBAAACxAADBACCDABxCCBABDBBDBCBCxCCCAADBBDDCxBDBADBACABBCCxADDBxAxDDDBDBxxCDCBAxDDACCCCABADBAABCBABDCxCxDDBBDDBDxAABABBBACCCBBCBCBCBCAADADBDCDBCCDABDDDACAAABDBDDDDxBBxCCBDBDDAxDDCAAxACDCBCCAAAxCBADBBCBAADDCCACBxCCAxCBDCDBDBACBDADACCAACAxBAxDCCBBDxAACCBDxxACDABBDDABDCDBBBCACAABCBxCxxBDBBBAxCCDDxCBDBDDBxAxxDBCBBBDDACxDxAxDACxDCAAACCBADBAABCCxDAABADxAACBACDCDDAACDBBCAADDDDAADDBxxCACACxDAxAxDDABBxAACxBCBACCCDBACCBACDxBxBAABACBBDAAxCCxABCxCACCCCxxBAxCCxDBDDACBDxBAABABDACABCxCxCxCCDxxBCDBBBDABCADABCADDAACCxCADCCACAAxABDxDCCAABBCxCBDDDDCAAACADDCABCDBDACAABACDBDCDBAABxAABCCAxCAABABCDBACBDDABACBAxCDCDAAxBDDCAABBABABBxCDAABDBCDDDDDDDCCACCCACCDAABBACDBACBDDxABAADAxCDCABCADDADDDBxBBCCABACxCCDDBCACABCBAACxBxBBDDCDCAxCBCBCDADDCBDAAACCDCxBxCACDACBDxxDBCCBxBBAAABDAAxCCCCDCCBBDDDCCADBCBDDBABBBCCCBBAAAACADAADBACACADDxBBCCBDxCCBCCAxxCAACBBCBxxCCBAACCxAADCBCBCDBCAAACDCCDCDxCADCCDBABDBCABCBDDABAACADDxDAxBBACABACDCDxAxDDCAAxAABBADxDxBCxBxACDBACCADDCBBCDAAADBABCxABCxACBDABBDBACCABDDxxCDABAxBDBBBDDDCDxxBDDBDDCDBDxBCCBBDxADDBAABCCxACAxBCBxDxDDDDABBxCADBADDAACDBACCBxxCAAxDDDADDDBDDACBDDBCCDBACDBAACxDBDACBCDDxAACDDxCBDCAxxDBxBDBDDDxCDAACBDDDCAACBADCxDABBBDAAAADBABAxABBADBBBDDABCACCAAADADDDBCxCBDDACDBACCCCCAAxBBBCBxDCBxxBBCCDxAxBAxBADDCBCADDCACxBAxBCCCCCBDCCAADBDCAADBAxBBCDABACDACxACCCxCADCBACBBDAxxxABxBDCxCBCABADCCCxADCAABBCDBACCxDAACDDxDCCAAACCCBADDCCBDDAxACADACBCDBACxCACBCBCDCDBDDAADADDxxxBDCCxDBDDCADCCCCxAAAxCDACCBDAxxDCDCCCxCxBAxBxDBACBDDDACACDDAACxxCBCACADDCBBxBBABCxCCAABAAAxACCABDCxACACBBDDADDDDACBBBBDDCDDBxBCDxAAACxCBDBCADBBACBBDCACDABCDxCBDABACCCDDBADDBCACACxDxBACBCAxCACAAxCADBDABDACADABAxBDADBxBDDCBADADCAxADCCxBCDxxBxADDAAxDDBBDxCAACDDBBBCADCBDCDAADBDACCCDCxBDDxBBCCCADABCCDDCDBBxDBBBxCBABDABBDACBBCBDxDDBCxCACDDADACxDBCCCACDDDxAAADAAADxBCCDCxADAAADDCDBAACBDCACBCBCADDCDCDBDDDxDCACADCCBDDAxBDBxAABBCADBxDCACABC")

(defparameter *input-3* "CxDCBCADBAACAxDCAxBCABBxxCDxDBxBxxBDCBAAxCABxDBBCxCCBCAAxBDDABAxxDBCAxxCDxxBBBDxBDDABBxBDADADxBDADxDAxxxxADCACCBxxDDCBCDxCCBBCBxDDxCCCCDxCBCCxABAxDxDDxDDAxCCACxDxDDxxADBDADDDxCDBAxCCBxACACCDCxxBBACCDACCDACDxDAxxABCDxACDDADCCBBCBxCCDCCxACBCCDCADAACCxDCBxCACDxxACxCCxxDBADADCDADBCBAxABACCCxBBBBAACDAxDAADBDCCBCCxADDCCxxDxDxDDCxAxxACDBDBxBCDACDCxCCBCBxAACxDDCDBBBxBADCDxxACxxAADDCCDBxCCBDDABAAxACDDACADBBCBxxDACBABDxxxAAACDCBADDDDBBAADBCACCAAABACxAxCAxBDBDBCBDAxCxCCCCABDBDDADCxxxCDxCxDBxxxBxxBxxACxCBBACDACxxCABCDBDBCABBxxBxCxBACxBABCDDDABDDBAAxADxDCBDxDxDABxBDxAxxDxxBBACxDBxAABxBxACCCCDAADBDDxxDDxDBBAADxxDBDAABABDBCDCxBxxCDABDCAAADCADDADxCDxxDBAxDDBxACxDAADCCBCBACAAABACDBADxCBxAxDAAxCDCDCBBDDBDBCxxxxAAADACBxCBCxCCAAAACCADxBCBDADBACADBxABDBADACCBxCCBDCAxBCxADxDCDDBABBDCCDCxDAABxABCBxDBAAABCDxACCxAAABBADxAAxCDABCxxBBDACABxDxBDCxCxxBCAxCAABCxDxDBCBxxCCDCxxDBxxBxBCBxADAxCCDACABDCDBDxDAxDCCBAAxCBCDCAAxBBAxxBACCBADCDCxxDAxCBADxBABBDCAADCBDxACBxBCxDDDDABDDCADBADCxADxABxCCCDCCxCAACBDCBxDACCCADDxBxDAxBBxCCBxCBCxCCBBBBABCBCxABACCCDxACCBBDCAAxAAxCCDAxxAABABDDACxCDDBCBAACCDxxBCCxCxDAAAxCCDAADBDDACACBxxxAxACBADCAAxxCBBCAxBBAABCCDDBDBBCCBCBABADADCCAxDCxBBCADAACxADCDAxBxBCAADCxBCCCABBDDCxACCBDDCBDBDDBDxCDxCxAxAADxxABADCABDCCACBDDxAxDBxDAxCDAAAxAxDDDxAABCBCDBBxBCxxAABDBBDCACACCBDABCDCDCxDxxBxDxDACCCBxCCDxCBBCABDACBBACxBBDDBDABDCABAAxCDDACBABCCBDxDADACDBCAABDACBBCBDCBDDAxxxxCxCBCDxxCACCDBDAxxDCBBCBxBCADCCCxCxBACxACDDxCBBDxCCCBxDBAxBCCDBAAADDDDDAxDDxxCDDAxBACxABxDCCCDDACDDDABCxDBCDDDBBxCDDBCBCACAxABBDBACBDBCxDCCAADxCCxBCxxBCBCxBxBCDCxADxxAAxxBBDxBxxACAACxACBADDAxBxADCDBBCAAAxxDDxDxxADCCADBADBCDDAxxDCCBABAADDDACAABCBADCABDCCCDBABxBDDxAxxBDCDCDCxCBCDDxxCCBDACDCBCCBCBDxxBBAADxAxAACCxBDBABDCxDCBCDDCDDxBxAxxADBCAAACxACDDDCAxACDxADxABBBxCABCCBCxxBBBACBDDxDxxCDBxABxDDADxCBCxDBDDBCDxDCCxCBCxBBxDBCACADxxxxxDxDxAABDCxADAAxBxxABCAAADCCxADBBCDBAxDAxDAxxCBCxACDxxADxxCCxDBDACDBCBBACADBADxxCDDCBDxCBCBCCBAxDxxADCBACCBAxADxDCDACADDABxDxxABxADCADDBAxCADBCBDBxDDAxAADxxBADCBCxDACDxBBDxDDxBBCxxCDBxxADAxBDDxAxxxAxBBxCADAxDADAxDDAAxADxBCDAADCCCAACBCCDBABBDADBBxDADCDBBAACxCBBxCCBAxDxCDADCxBDDxCDxxxACCCCDDBxAxDxBBCxxxDDCBxBAADADCxADBDCBBCBDCCxDDDBBAxCDDABxCAxACDxDCAACBCxCADxDDxxDCDDCxBADCABBBAACAACBCxxxCxCDCBAxDxCxBACCDDABACxBBBACDCDAAABxCBDBBBDCDAADACDCDDBDBAxCAADxBDAACCDACDBACxCBADCCABxACCBAxCADDxDDAABAABCAxDACxADBDCBADDDBACDBDxCxxCAABDBBBBxAAABDAAABBDDDxxBCDDBADxxxDxDCADACxxxDABxDxBABxDAADABBBBBxDABACxBDxCDBxBCCBAxADxDCCBBDDDACAxxxDCABBBCADxxDBABBCxxDDCCABxCxDADxCBBACxCBxDBDCCCxDCDBBBABAACAxAAxDBBACBADCBCxxCAxxAABAxAxCDDCBAADABBCxDxCCCBABxBBxxAAxxAADDDCCCCDDDxDDBCCABABxxBABCxCDxABABCBBxCABCABxxAADxCABxxAAAxDAxDxBCBDxxDAxBDxBCxAxxBABBBBBCCCCAABAxAADxBDBxAxCABCBBAxxABxxBBDDCCxABxBxADDBBAADxDxxBxACADBCCxCBDBACAACCxCBCCDACBCDxDxxCADABCxBBAACDBxACABxADBxDBxAAxDxAADDxCAAxBAxDxBxCABDBBCBDDCCDACBDCADDBBCxCDCDCxCCxBCBCBCAACADBxBxBCAxDAAAxADxBBDBxBCACCCCxDxCxBCBABADBBBBCxBxDxDxACDBCDCxCxxADDCACCDxBCDACBDAxAxxBBxxBBBxBxAxBBxAACxDCAAxxCDBxxBBAACBDCDDADACCADDDDxxAxxCCAxADxxBADxDDABxBDCxxBBCBxBABBxCxCBAxAAxDCACACBAxAxxAxBDCAAAxxDBDADCDxCDBCCBBBADDCBAAAxDCxBDCAxACADCCBDBBADBBDACBxBCABBCBDDxxADBABDxDxDDADDBBBBxBADDBDDxCxCCDACBADCBxxBAxxCxABCADxDxxAxCADDBAxxADBDxABDCABxDxDABDDBACxCBCBDxBDDxDCAAACAxxBAADAACxBCDBACCCDAxDDAAxxDACBBDDCAAxxCBACBAABxDBDDAxDxxCDDBBDCxxxAxxAxxACCACAABDBxCAxAADCCxBBDxAxDABBBAxACAAAxCAxBACCxDCCxxCAxBDAABDxCBDBBADCDCAxDCBxACAxDDCxAxCCBxDxBBCBxCBDCAADACxCACACCCxDDCADBBCCCDDACDCCBxBxCBxAxDABxCAxBCBDxBxCBxADDDxDABCBACxCDDBxDBDCxDCBxxAACAxDDxBDABDADDCxACADBADCxBAACBDBDCBBxxABxCxDxCAxCBBADDDABCBBADDDBxABAxxBAAAAxBDDABCCABBxxBxCCxAABBBDACAADDDCDDACDAAxBCBBBBADDCxDBBxxBADxxxBDCxxAxCxBBDBBCDACDxBCxDCBBDADDBxDCABCBDxDDxBBDACBCDDAxDCDCAxDxCDCBCxBACBxBBCxCCADCDDDCDxDBCDABDCDDxDCAABBBBCADAxDABAAADCBCDADDABxxxCDBxBACxCDBAAADCDxACxDDABDCDxDBCCBCCBDCDAxDCDABCDDBBADDDBDCBxCxACxCCADxBCABxADxDDBABxxBCCxxACCxxCxxCCDCAxxDxCxBBCCBBDDBDAAxDxBBxDxDDxACDCDADxxDBDDDCCAACDCBCCACABBAADAAAxDADAxCBxAxBCACBADDAxxCDAABxACAACDBBBBABBDxBCxADxxACxACxDBDBDBxBxDxBCxxBBCCAxCDDxAAxBDABCBxDCABADDACxBxAABCxDxxCBABCCBCxxABxDCACDxxxBxCDxxCCBDAxAAxACADxBCxCAAABDBCxAACDBxxDDCDBxCABAACCABxxCDCxxDxCDBDABDDCDCCCCBADBDABxBDACDxDDADACDDxBCCxDABBAxBABDDCxDDADxCxCBDDBCDxCDxxDADCDADxCAABDCBDCDxBAACxBCBCDAxxCAxCCxDADDxBBDxAxAACCCxBABCBDDCCxBCABDxAxDBCCDxBDBCAABBAABCxABBDxxCBABDxAADBDBBDDxDAAAxDDxDAAxxDDCxCBDCBDDDDxCxDBBDAxBCDBxAAADACBBxCBAxABABxABDABxBxxAADDDCxACxCABDDDxDBDDBCADCCxxxBCCxDBCCAAADxxACACAxxACBCDxABCCBABBBxBDCDCBxAxxBABAxxAAACxDCCDCAxxAAADBDAAABBxxCBABADDACDDCBxBCDCAxCBDAAxBDDxDxDCCxxACBACCDCBCCBCCxACxAxBCADACxBBxBxCDCAxCDCxBDCxCDCDCAxAAxADDCxAxBxxAACBDCCBDACBDCCDxxBBCAxCDxBxAxxCBCBDBCBBDADDBCBCBxBDCAxCxBDBBDBBBBxBxAxACCxDBCBxCDBDAxCACxDDCBAADDDxxAxDAxCCDxDCBxCBBACDADCDCxxCBDAADCDBBxDBCDDxACACACDCxDAxxDDAAADABxDCBDCDCDAxAADAAxBxCCxxAABCBxxCxDCxADCACBCCCAxxxAABABADADxxCDBxABBDCxAxDABBxxxADDBDCCDCxCCACxxAADxCBBxDCDBBDBBDxCxxCCCACDCABBCBCBADABxCCCCBAxCDCBBBDxCBCxADABxDCxCCCACCADAABABDCxxCCCxAxCBCxABADBCCDADBxADAxxCAACADxDxCBBACDxBABxxDAxDDDBDBxCCCBAADACCCADADxDBCxBCBCCBDDxCBBCAADCABDCDADBDBxCBDDxBxDAxxDDBDBBCDDDACDDCDDACxDABxDxAAADDDAAAxACBBAxCxAxBDAxDxCxxABBCDAxBAxDADAAAAACCCCCCDABCCBxDCBDDBxBDCDxBxCBAxDCxBxABDDBAABBBCABDBBxBDxBADBDDBCBBDDCDBxBxBDCABCCBxDxCxBBDxxDBBBBBxDBCCCBCCACACADxCAABACCABBADBAACAxxADCxCADDADBxABBCBCCDCCBDAxxAxCBBAABACDBBABxxxBDxBCDCCBCxADCAxBACDCBCCDCBDDDCADBBxCBxxCDACBADxxDDCACABCxxxxBCDDCxBAABxCxBDCCADDCDBxBABxBAxBDAABDDABADDABDCCAxDxxDCAABxxCxDBCBABxBxBAxxAAxADADCBCABBCDxBBABBCBCCBCxDxCCACCDxBBDCxBDDAACxACDCAABADCABACCDxABADDxCCDxCACDCDBAADxBCAxABxDBxDBABxDDADBCxCxABBBBBABxDBBDDxCBADBDCADDCCDDCDBDBCCCDDDCCDCDADCABDACBAxDxCDBABBCBDDBBBDCBDBCBBADxxCDDDAABABADAADCxAADBADxxBCCADBCCCCxxADBCCADAADADCBABAxCxBACBxADCBBCCCCCDAxAxABBAxxDDBDxxxBADAxBxADADADCxDxxAxxCBABCDCxBADBCCBCDxAAxDxCCAxCCDCCBDBBDBCCBABAxDDDxAADDDBxCxCxCDBCxxxCBDDxxxBBADBDDADDBACxxxxBxAABxCxCDBBCACCDDCCCxDCAxCCBxDCCDDDABBCDDxDBxAAxDDCCCACDxBCAAxxDxxBBABBACCABACBxBDABADCCABxCCAAxBAABDDCADBACDxCADADBDAxBBDBxCxxAxAxDxBBCxAxBAAACxBBCCDCxDBCDACDxBCxAAADADBBAAADDxAAxDADACxDAAAADxAADCxCCDCAADAABABBxxDCDDBACAxxBABDBBBxBxBxABxBxDDxBDBBAADBxxDDxBDABxABxBABBBDADDCABBxAADBDACxBAABABDCCDDACBxCxxBxDBCCxAxCAxBCAACxDCCCBBCCBBCACDAxCxxDABxxAxDABxDDBCCDABDAxADACxxDCAADABCCCBBAxAxBxCADxABDCBDACCBABABxBxAxDBCBACCDxDBBDBCABCDxxxAxAADBBBxBAAxxBxADAxACAxBBBxBCDxAxDDCCxDxBCABBxBBAxDxCADxBxBAAxxBxBDAAAxCABCxDBCBBCBBAxxCBBDDxxCABDxDAADxCAACxAABACDACACDBDBABxACDADxCCCABDCAxCCDAxABDABBxACAxCCBDDxADCCADCxBCxDAxxxAxCCAxxxDADACxxBCBCxDABCBBAxBDBxxCCAxxCxCCDBCABDxBADDxBxACDxAxCxBDBAxxCxDBDDxABDDCCABCxCxxBBxAADCxBCDCABCAxDxxCxxCBDACACAACxDCBCDxCDACACDBCxABDACDxBBDABCCCDDCDCBAxAAxDBDxDDDxDxACBAxxDBADDxBBBACBBBxABAACDBxDxDDBxABxADBxACABBxCBACAxAAAxBxCABCCxABBBCxDAxCDBADAxDDDCDCAAxAABDCCBBxxBxxBBBDxxADxACBxxAxxBBxCxCxBCxCACBxCDBBCDDDAxDDBxCCxxBCDBxAxAxCDxDxDCADCADCxxxAxCxCCxxAxAAxDDAAAADxxDADxAxBADxxADCBDxxDDBADDDBBCxDDxDxDDCDAxDDAxBDDBAAAAxCBCBDDBBDCCxCADDxCCDxADBxAxDCCBAADCBDBDADBxAxACBAxxDDABDxABCCDCxDDBAADDADADAxxAxCxxCCDABDBBDxBDxxCBxADxxDADCBxCxxCDDABCCxDABBDDCxxDxxxADDAABAABDCABDCBxABBxACBCxDBxBBDABDABCAxCBAAADAAxxADxDBCDABBBBxBBxBCAxBDxBDCBxBDCCxCDCBxCABAxADCBDBDBCCBCCBBCACBxxCxBDBDCAxAxxCADxxxCACCABDBCBABDxBCDACCxxCDADxBBCxBCCBxDxDDBxBAxBBAAAxAABBDCxxACBBBCxABBABBCxACBxCABBCADCCADAxADBAxDCADBDDCACCxCBDxABCDDBxCxBBAxABDCCADBCBBBxBxCxADACCxxACDAxxxCACDBDBBDACCDBBBDxCCBDBDxBDDBxBACADBxABBDCBBADDBDxCAxxCCBBCDxCxCACABxBCCBxBCBBxDABxCDDxCACCDDABxCADxCBBDDBBxADCDBCBBxxCDxCCADxDxxxCCxBCBxxBABxACBDDCCADxABDDxxCDAADDDCDCCDADxCADBADADDBBCDAxABBDxAxDDxCAxxBBBxxxBCxDCxABxCDBADAACxxDBBDxDDBDCxADDxDCDBDDxxAxACCAxDBxBDxDCxBAABABAAAxDABDDCABCDBBCDxxDBCBxDABACxBDxCDBBDxBDBDCCCAABBAAAACCDBxDAABCCACDDADDABxCAxDBBxxAxAACABxAABCxxxBDAxCCBxCCBAADxCBACBBCCBxAxCDDABBDxDBDBxDBCxDACBBxAABBABCBDBBDDBABDAxBDAABAxCCCCDCDDCACADxDCAxBDxCxCBxBxDDxACBCCAxAxDCBBxxxCCDCCxDAABBxBBDADACBCBBBCBxDDCxBACDABxADDDDBBxAAxBCABCBxBAADCBBACABADABxCBCAxABCACACCBxDAACDDxADDABxBDDDDCDDCCDDBDDACAxBBDCxCCBDDAxDCCCxBBCDACADBxBADxDDBxCDDAABDDxADAACBxCxDxxCCAAxCACDCABDCCBxDBBDCABCDDxBBBABxDBDDDCBDxBBBCBAxCADADCxAxBBADCxABxCDDDDCADxCBCBxAxCCAxBBxCDDDDxCBDDAxAxxBxBDAAACDxBxCABADADBBxxxDCDCBCBDDCCBBDBxxDxAABADDxBCABxxCAxABAADDxDDACAABBBCCBDAADABDDCCBxDADBBDACBxCAABCxCDBCAxADDCABDCxADBDDDBAxBDACBxBBxBxBADCDAADACCBBDxDABxCAAxCxCCCCCDCDCBxxADDxBADACxBDxBDAxCxACDADBCBDCCCDDxxCDADDxCxACAAADBDCDxBADAxCABAxxAxADDxDxBxCCBBACADxBBDBDDABCBCxCxBBDxBADDBAxDDCDxxABADCDBCBBCCCDDDBBACCxDAACDDAAAxACxxCxxACxBxDDxBxCBAxxCBBABCxAAxBABDACBxBxxCxDAxxCxCABDBBBxCDCCDBABDDCxBCBDCDCAxxBCxBCBBACADAxBABBCCCACAxxCDCBCDDxCBCCBxDxCCDADxxBCBADBDDCACABxBxCBCAAxDCDBABBABBBBDxxxBDBBxAxDBBxCxDABAAxDDxCxCxDxBACBBxDxADDACACDCAAAxxBCDBCAADCBBCBCxDBBCxBCCDDxDCxBBxCAAAAABACBABCBACBDBDxBDDAAxAAxCCBDACxBDBDABADBBADxBCxBBDAADABBDBABCAABxCCDABxAADCADDxABCBBAADBBCBCADCCxBBxAxBBDAAxDDBBxDADCCBDACCCDCADBDADxBCCxxDAxBABACCCxBACxDBBADxCxACBCCACBBABACBBDAxBDDBADCDDAxCAACBBABDABxDCBBxCDAxDACxxDAAAAAAACCxACCAAACBDDBxDxDxBADDADADADxDAxxBBBBADCBBADBCCAAACxBBACBBxBxxBAABCxxxAxCDDCAxxBDACxCADBBxDADCDCCABBxDDBBCBBAADACCxCBxxBADBBxCCBDDxAACDBxBADADxBBBCxxDAxDBBCABAB")

(defparameter *potions-reqs*
  '((#\A . 0)
    (#\B . 1)
    (#\C . 3)
    (#\D . 5)))

(defun count-potions-1 (&optional (input *input-1*))
  (loop for c across input
        for p = (cdr (assoc c *potions-reqs*))
        when p
          sum p))

(defun count-potions-2 (&optional (input *input-2*))
  (loop for (c1 c2) on (coerce input 'list) by #'cddr
        for p1 = (cdr (assoc c1 *potions-reqs*))
        for p2 = (cdr (assoc c2 *potions-reqs*))
        when (and p1 p2)
          do
             (incf p1)
             (incf p2)
        sum (+ (or p1 0) (or p2 0))))

(defun count-potions-3 (&optional (input *input-3*))
  (loop for (c1 c2 c3) on (coerce input 'list) by #'cdddr
        for p1 = (cdr (assoc c1 *potions-reqs*))
        for p2 = (cdr (assoc c2 *potions-reqs*))
        for p3 = (cdr (assoc c3 *potions-reqs*))
        for groupcount = (count-if #'identity (list p1 p2 p3))
        for bonus = (case groupcount
                      (2 2)
                      (3 6)
                      (otherwise 0))
        sum (+ (or p1 0) (or p2 0) (or p3 0) bonus)))
