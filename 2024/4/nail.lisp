(defparameter *demo-nails*
  '(3
    4
    7
    8))

(defparameter *part1-nails* '(14
                              18
                              12
                              16
                              15
                              10
                              7
                              12
                              10
                              10
                              11))

(defparameter *part2-nails* '(6413
                              5237
                              5834
                              2777
                              1551
                              3057
                              1971
                              5401
                              8999
                              9157
                              6407
                              9401
                              3066
                              3321
                              7610
                              9283
                              6816
                              1305
                              9052
                              2866
                              7020
                              4593
                              7478
                              3444
                              7612
                              5180
                              9284
                              3935
                              2429
                              7365
                              5779
                              8304
                              8562
                              5609
                              5690
                              9934
                              1763
                              8125
                              9182
                              1683
                              6821
                              7500
                              5338
                              1033
                              3960
                              3499
                              4363
                              6751
                              8707
                              1042
                              7047
                              9269
                              1339
                              1013
                              3582
                              3429
                              8609
                              2599
                              3341
                              2128
                              4312
                              1362
                              7828
                              3968
                              2253
                              2026
                              9309
                              2285
                              7946
                              3176
                              6758
                              9336
                              1916
                              4130
                              4346
                              1322
                              9462
                              4127
                              7381
                              4640
                              5304
                              7543
                              1551
                              2946
                              4663
                              7113
                              1307
                              9295
                              2411
                              3355
                              4188
                              4200
                              6381
                              5970
                              3166
                              8000
                              9715
                              2646
                              8976
                              1310
                              5675
                              3201
                              8633
                              9707
                              3029
                              4550
                              7953
                              3327
                              8908
                              6626
                              4851
                              5841
                              4874
                              6068
                              2872
                              2831
                              3851
                              2245
                              6950
                              9513
                              8601
                              3614
                              4595
                              4668
                              9709
                              8486
                              4747
                              1053
                              4904
                              5589
                              2553
                              3829
                              1324
                              3926
                              2876
                              7017
                              4648
                              8800
                              4653
                              1689
                              6055
                              8055
                              9748
                              2473
                              9874
                              6331
                              1258
                              7992
                              3947
                              2250
                              6695
                              4825
                              6378
                              8018
                              9131
                              9731
                              7930
                              5220
                              4964
                              1613
                              3974
                              4291
                              3403
                              3105
                              6785
                              1622
                              4045
                              4410
                              1728
                              9902
                              4550
                              5200
                              1438
                              5682
                              3291
                              9510
                              6642
                              5654
                              3813
                              3553
                              4082
                              7356
                              2040
                              2405
                              6684
                              2556
                              4972
                              2457
                              4055
                              7008
                              3822
                              5309
                              4082
                              9590
                              2711
                              9913
                              8525
                              2283
                              1432
                              9748))

(defun min-nail (nails)
  (apply #'min nails))

(defun nail-diffs (floor nails)
  (mapcar #'(lambda (n) (- n floor))
          nails))

(defun total-leveling (nails)
  (reduce #'+ (nail-diffs (min-nail nails) nails)))
