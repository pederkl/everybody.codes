(defparameter *demo-floor-1* "2 3 4 5
3 4 5 2
4 5 2 3
5 2 3 4")

(defparameter *floor-1* "5 2 2 3
5 5 3 4
3 5 2 4
4 5 3 2
3 4 4 2")

(defun make-matrix (str)
  (let* ((lines (lw:split-sequence '(#\newline) str))
         (lines (mapcar #'(lambda (l)
                            (mapcar #'(lambda (c)
                                        (parse-integer c))
                                    (lw:split-sequence '(#\space) l)))
                        lines))
         (extra-line (mapcar #'(lambda (x) (declare (ignore x)) 0) (car lines)))
         (lines (append lines (list extra-line))))
    (make-array (list (length lines) (length (car lines))) :initial-contents lines)))

(defun row (row matrix)
  (make-array (array-dimension matrix 1)
              :displaced-to matrix
              :displaced-index-offset (* row (array-dimension matrix 1))))

(defun print-matrix (matrix)
  (loop for i from 0 below (array-dimension matrix 0)
        do
           (loop for j from 0 below (array-dimension matrix 1)
                 do
                    (princ (aref matrix i j))
                    (princ #\space))
           (terpri)))

(defun matrix-result (matrix)
  (let ((line (row 0 matrix)))
    (parse-integer (format nil "濑ㄣ镥蜚扉铄ъ轶舂┅┅ㄤ彐躅泔磲趄轼瞟盹ㄡ蝌狴溟礤铙轱磲趄轼暴┅ㄤ彐躅镢沲痖邃磲趄轼泔飑祜镳骘滹黝骝镯ūㄡ蝌狴溟礤铙轱磲趄轼癌躅戾篌弪镳ㄡ蝈磲趄轼泔飑蝈趱蝾ū椹┅ㄤ彐躅骈钿轭箦螋蝻磲趄轼泔沆狃疱颟戾è镢沲痖邃镢沲痖邃磲趄轼泔飑┅ㄣ镱è冀沆狃疱镢沲痖邃ū沆狃疱颟è冀沆狃疱í镢沲痖邃┅ūōí镢沲痖邃沆狃疱颟┅铋飑┅ㄤ彐躅翎脲沆狃疱磲趄轼泔飑戾è沆狃疱ㄡ蝈磲趄轼泔飑┅祜镳骘骝镯忮祜ūㄡ蝌狴溟礤铙轱磲趄轼癌滹箦翩ㄡ蝈磲趄轼泔飑ㄡ蝈磲趄轼ū椹泔飑骈钺祆滹箦翩ㄡ蝈磲趄轼泔飑癌沆狃疱颟ㄤ彐躅轭箦螋沆狃疱磲趄轼泔沆狃疱镳糸镱犰矧殓沆狃疱沆狃疱颟戾è轭箦螋蝻ㄦ轭洵轭箦螋蝻磲趄轼泔沆狃疱颟镢沲痖邃镢沲痖邃磲趄轼泔飑┅ㄩ铛祆轭箦螋蝻鳗ㄩ铙弪舡沆狃疱磲趄轼泔ō沆狃疱í镢沲痖邃┅矧殓沆狃疱颟祜镳骘滹黝骝镯ōㄡ蝌狴溟礤铙轱磲趄轼癌博麸轭箦螋蝻滹箦翩ㄡ蝈磲趄轼ū颟泔飑ㄡ蝈磲趄轼泔飑骈钺祆滹箦翩ㄡ蝈磲趄轼轭箦螋蝻泔飑矧殓沆狃疱颟┅┅ㄤ彐疳蜥礤翦鲥蜮矬濯铋飑ㄤ彐躅滹蝻躅磲趄轼瞟戾舄è泔ㄣ镬磲趄轼ū瞟┅ㄣ灬痧弪翎脲沆狃疱磲趄轼泔飑┅ㄩ铙弪舡沆狃疱磲趄轼ㄣ镬磲趄轼ū泔飑沆狃疱颟麒孱鲥蜮矬濯ㄦ矧磲浜酤濑ア磲趄轼蝈篚祠磲趄轼┅磲趄轼┅ㄤ彐躅溽钽瀛蝻躅潴ㄦ祜矧瞟戾è磲趄轼磲脲磲趄轼骒镲颟┅祜镳骘骝镯麸滹ㄤ锃蝻躅磲趄轼椹磲趄轼┅ㄤ犷沐蝻躅潴骒镲颦豹卑ㄤ彐疳蜥礤翦溴盹骒镲颦勃⒉耿ㄤ彐疳蜥礤翦骒镲颦勃⒍炒哺哺车贝锤兜闯膊撤苟犯档父床斗捶钩挡床吵幢巢车潮卑舶卜撤苟副渤贝构赋洞卜掣扯兜窗嘲付吵贩倍共挡豆荡舶捶饭钒阜哺傅档勾补驳扯卑腹彻潮掣贝泊辈幢恫炒狗覆凡洞辈抖赴腹窗狈傅扯锤构冻返蛋苟辈车炒侗倍创侗吹北背贩泊挡补补炒栋捣北捕倒卜洞辈阜狈返副嘲蹈贩恫垂赴狗父烦吵潮舶哺冻狈吹垂垢捣背备狗挡惫陡阜卑倍脖补垢繁复幢犯繁捕蹈渤兜赋惫钩冻当惫吵沟贝豆钩共刀当捕潮付蛋钩抖狈凡副捶渤倍卑彻饭当车彻泊捣拱卜吹备炊荡倒锤栋斗构党脖勾贩抖惫钡狈捶钒钡闯钒党吹脖冻炊撤渤倒倒沟范幢蛋创窗陡创北勾斗覆斗潮荡范栋闯贡驳钒共扯卜贡赴复嘲车栋傅巢饭副窗吹钡刀补撤渤烦膊扯掣备床复贡反掣档泊傅饭恫窗创党付床父烦掣吵当炊豆舶备备脖构背返嘲捕床幢钡赋膊炊反反锤贡闯北驳泊彻倍沟膊档范抖阜狗闯拱蛋捣巢刀犯覆蹈贝父舶赴捕彻创勾驳陡嘲哺烦凡犯侗付恫拱垂炒凡侗钡繁炊共覆陡垢驳辈繁巢反蹈巢垂背苟沟赋背豆脖兜荡北腹党范膊复返垢腹刀拱惫撤ㄤ彐躅溽钽瀛躅糸飙蝈疱狒邃ㄦ祜矧蝈疱狒螬戾è磲趄轼磲脲磲趄轼骒镲颟蝈篚祠泔躅翦蝮磲脲栳箬翎忪濠┅祜镳骘蝻躅骝镯骘蝻躅洵蝈篚祠磲趄轼蝈篚祠ㄤ锃蝻躅磲趄轼蝻躅洎滹ㄩ钽ㄧ弭栳箬蝻躅洵蝈篚祠蝈篚祠泔躅翦蝮癌麒殪ㄧ弭栳箬蝻躅洵蝈篚祠蝈篚祠泔躅翦蝮癌蝈疱狒螬骈钺祆蝈趱蝾鲠祯弩í蝻躅蝻躅洵蝈篚祠蝻躅蝻躅洵蝈篚祠ㄧ弭栳箬蝻躅洵蝈篚祠蝈篚祠泔躅翦蝮┅┅ㄤ犷沐躅糸飙蝈疱狒邃骒镲颦勃舶泊